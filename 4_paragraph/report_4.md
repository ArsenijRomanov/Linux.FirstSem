# Отчёт №4

## Цель работы
- Отработать приёмы массового редактирования в Vim: визуальный режим, команды изменения регистра, макросы.
- Освоить связь Vim с оболочкой (вставка даты) и преобразование текста/структурированных данных.

## Среда выполнения
- ОС: Ubuntu
- Редактор: Vim
- Утилита для массового переименования: `vidir` (moreutils)

---

## Ход работы

## 1) Массовое переименование файлов (vidir)
### Решение (последовательность действий/клавиш)
```text
в директории: 
env EDITOR=vim vidir

1) Esc
2) ggVG
3) g~
4) :wq + Enter
```

---

## 2) Массовая обработка строк (макрос: обернуть строку в кавычки)
### Тестовые данные
```text
hello world
 a line with leading white space
1
!@#$%^&*()
```

### Решение (описание макроса/клавиш)
```text
1. vim [file]

2. Esc

3. q для записи регистра

4. символ - имя регистра

5. начало строки (0) -> режим вставки (i) -> (") -> режим вставки (Esc) -> конец строки ($) ->
	-> вставка в конец строки (a) -> (") -> завершение записи макроса (Esc) -> перейти на следующую строку (j) -> (q)

6. Использование макроса:
	Esc - командный режим
	@(имя макроса)
	N@(имя макроса) - повторить макрос N раз
```

---

## 3) Связь с оболочкой (вставка текущей даты)
### Решение (клавиши)
```text
1. Esc
2. o — это создаст новую строку под текущей и перейдет в режим вставки.
3. Ctrl+R, затем =
4. strftime("%c")
5. Esc
```

---

## 4) Преобразование XML в Java properties (макрос)
### Тестовые данные (XML)
```xml
<property>
  <name>dfs.namenode.name.dir</name>
  <value>/var/hdfs/name</value>
</property>
<property>
  <name>dfs.namenode.data.dir</name>
  <value>/var/hdfs/data</value>
</property>
```

### Решение (описание действий/команд)
```text
Записать макрос:
1. Esc

2. Нажать q и выбрать регистр

3. Перейти в начало строки с тегом <name> с помощью команды /<name>

4. Перейти к закрывающему тегу </name> с помощью команды /<\/name>

5. Перейти к тегу <value> с помощью команды / <value> и затем к закрывающему тегу </value>.

6. Преобразование строки в нужный формат:
Например, для первого элемента создать строку:

%s/<property>\n*\s*<name>\(.*\)<\/name>\n*\s*<value>\(.*\)<\/value>\n*<\/property>/\1=\2/g

Эта команда заменит все вхождения вида:
<name>dfs.namenode.name.dir</name>
<value>/var/hdfs/name</value>

на:
dfs.namenode.name.dir=/var/hdfs/name

Завершить запись макроса: q
```

---

## Вывод
Закреплены базовые приёмы Vim для массовых правок: выделение и преобразование регистра, запись/повторение макросов, вставка данных через выражение, а также подход к преобразованию XML в формат Java Properties.
